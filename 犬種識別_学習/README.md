# 犬種識別アプリケーション

## プロジェクト概要

このプロジェクトは、UdacityのAI Nanodegreeプログラムの一部として開発された犬種識別アプリケーションです。画像に写っているのが犬か人間かを判定し、犬の場合は犬種を、人間の場合は最も似ている犬種を予測します。

## 機能

- **人間検出**: OpenCVのHaar特徴ベースカスケード分類器を使用して人間の顔を検出
- **犬検出**: 事前訓練済みResNet-50モデルを使用して犬を検出
- **犬種分類**: 転移学習を活用したCNNモデルで133種類の犬種を分類
- **統合アルゴリズム**: 入力画像に対して適切な処理を自動選択

## 技術スタック

- **Python 3.x**
- **Keras/TensorFlow**: 深層学習フレームワーク
- **OpenCV**: 画像処理と顔検出
- **scikit-learn**: データ処理
- **NumPy**: 数値計算
- **Matplotlib**: 可視化

## モデルアーキテクチャ

### 1. 人間検出器
- OpenCVのHaar特徴ベースカスケード分類器
- 検出精度: 人間画像98%、犬画像11%

### 2. 犬検出器
- 事前訓練済みResNet-50モデル
- ImageNetデータセットで訓練
- 検出精度: 人間画像1%、犬画像100%

### 3. 犬種分類器
- **スクラッチ構築モデル**: 3層のCNN（精度3.47%）
- **VGG-16転移学習モデル**: 精度44.98%
- **ResNet-50転移学習モデル**: 精度81.10%（最終モデル）

## データセット

- **犬画像**: 8,351枚の画像、133種類の犬種
  - 訓練用: 6,680枚
  - 検証用: 835枚
  - テスト用: 836枚
- **人間画像**: 13,233枚の画像（LFWデータセット）

## ファイル構成

```
犬種識別_学習/
├── dog_app.ipynb          # メインのJupyterノートブック
├── report.pdf             # プロジェクトレポート
└── README.md              # このファイル
```

## 使用方法

1. 必要なライブラリをインストール:
```bash
pip install tensorflow keras opencv-python scikit-learn numpy matplotlib pillow
```

2. データセットを準備:
   - `dogImages/` フォルダに犬の画像データセット
   - `lfw/` フォルダに人間の画像データセット
   - `bottleneck_features/` フォルダに事前計算された特徴量
   - `saved_models/` フォルダに保存されたモデル

3. Jupyterノートブックを実行:
```bash
jupyter notebook dog_app.ipynb
```

## アルゴリズムの流れ

1. **入力画像の読み込み**
2. **犬検出**: ResNet-50を使用
   - 犬が検出された場合 → 犬種分類を実行
3. **人間検出**: OpenCVを使用
   - 人間が検出された場合 → 似ている犬種を予測
4. **結果表示**: 予測結果と画像を表示

## 性能評価

- **人間検出器**: 98%の精度（人間画像）、11%の誤検出（犬画像）
- **犬検出器**: 100%の精度（犬画像）、1%の誤検出（人間画像）
- **犬種分類器**: 81.10%のテスト精度

## 改善点

1. **データ拡張**: より多様な画像データの追加
2. **モデル最適化**: ハイパーパラメータの調整
3. **エラーハンドリング**: より堅牢なエラー処理の実装
4. **UI改善**: より使いやすいユーザーインターフェース

## ライセンス

このプロジェクトはUdacityのAI Nanodegreeプログラムの一部として作成されました。

## 作者

Udacity AI Nanodegree 受講生
